<!doctype html>
<html lang="ka">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <title>Admin Command Center â€” Game Debate v4.0</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Oswald:wght@400;700&display=swap"
        rel="stylesheet" />
    <style>
        :root {
            --bg: #050208;
            --panel: rgba(20, 15, 30, 0.7);
            --panel-2: rgba(30, 25, 50, 0.85);
            --accent: #8a4dff;
            --accent-glow: rgba(138, 77, 255, 0.4);
            --accent-2: #b58bff;
            --muted: #a496b8;
            --text: #f2eef7;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
            --danger: #ff4757;
            --success: #2ed573;
            --shadow: 0 30px 60px rgba(0, 0, 0, 0.7);
            --transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        * {
            box-sizing: border-box;
            outline: none;
        }

        body {
            margin: 0;
            color: var(--text);
            font-family: "Rajdhani", sans-serif;
            background: var(--bg);
            overflow: hidden;
            /* Control scroll within dashboard */
            width: 100vw;
            height: 100vh;
            display: none;
            /* Security check */
        }

        /* CYBER BACKGROUND */
        #modern-background {
            position: fixed;
            inset: 0;
            z-index: -1;
            background: linear-gradient(-45deg, #050208, #120626, #240c42, #0d041c);
            background-size: 400% 400%;
            animation: modernGradient 18s ease infinite;
        }

        @keyframes modernGradient {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* DASHBOARD LAYOUT */
        .dashboard {
            display: flex;
            width: 100%;
            height: 100vh;
            backdrop-filter: blur(20px);
        }

        /* SIDEBAR */
        .sidebar {
            width: 320px;
            background: rgba(15, 10, 25, 0.9);
            border-right: 1px solid var(--glass-border);
            padding: 40px 0;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .logo-area {
            padding: 0 40px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: 30px;
        }

        .logo {
            font-family: "Oswald";
            font-size: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #fff;
            text-decoration: none;
        }

        .logo b {
            color: var(--accent);
        }

        .menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .menu-item {
            padding: 18px 40px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--muted);
            cursor: pointer;
            transition: var(--transition);
            border-left: 4px solid transparent;
            font-weight: 600;
            font-size: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .menu-item:hover,
        .menu-item.active {
            background: rgba(138, 77, 255, 0.1);
            color: #fff;
            border-left-color: var(--accent);
        }

        .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* ANALYTICS UI */
        .analytics-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .dark-card {
            background: var(--panel);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .card-title {
            font-family: "Oswald";
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 18px;
            color: #fff;
        }

        .trend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .trend-label {
            color: var(--muted);
            font-weight: 600;
        }

        .trend-value {
            font-family: "Oswald";
            font-size: 20px;
            color: var(--accent-2);
        }

        .country-row {
            padding: 12px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .country-bar-bg {
            flex-grow: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
            overflow: hidden;
        }

        .country-bar {
            height: 100%;
            background: var(--accent);
            border-radius: 3px;
            box-shadow: 0 0 10px var(--accent-glow);
        }

        .country-info {
            width: 120px;
            font-size: 14px;
            font-weight: 600;
        }

        .country-count {
            width: 40px;
            text-align: right;
            font-family: monospace;
            color: var(--accent-2);
        }

        .user-info {
            margin-top: auto;
            padding: 30px 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid var(--accent);
            object-fit: cover;
        }

        .user-details h4 {
            margin: 0;
            font-size: 16px;
            color: #fff;
        }

        .user-details p {
            margin: 0;
            font-size: 12px;
            color: var(--accent-2);
            text-transform: uppercase;
        }

        /* CONTENT AREA */
        .content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 40px 60px;
            background: rgba(0, 0, 0, 0.2);
        }

        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .section-title {
            font-family: "Oswald";
            font-size: 32px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: var(--panel);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 30px;
            transition: var(--transition);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .stat-card:hover {
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .stat-label {
            font-size: 12px;
            font-weight: 700;
            color: var(--accent-2);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            display: block;
        }

        .stat-value {
            font-family: "Oswald";
            font-size: 42px;
            color: #fff;
            font-weight: 700;
        }

        /* TABLE SECTION */
        .data-table-container {
            background: var(--panel);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .table-header {
            padding: 30px 40px;
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            padding: 20px 40px;
            text-align: left;
            font-size: 11px;
            text-transform: uppercase;
            color: var(--muted);
            border-bottom: 1px solid var(--glass-border);
        }

        .data-table td {
            padding: 18px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
            font-size: 14px;
        }

        .data-table tr:hover td {
            background: rgba(138, 77, 255, 0.05);
        }

        .badge {
            padding: 5px 12px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .badge.admin {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
            border: 1px solid #ff4757;
        }

        .badge.user {
            background: rgba(46, 213, 115, 0.2);
            color: #2ed573;
            border: 1px solid #2ed573;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: #fff;
            padding: 8px 15px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            transition: 0.3s;
            margin-right: 5px;
        }

        .action-btn:hover {
            background: var(--accent);
            border-color: var(--accent);
        }

        .action-btn.del {
            color: var(--danger);
        }

        .action-btn.del:hover {
            background: var(--danger);
            color: #fff;
        }

        /* UTILS */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--accent);
            padding: 15px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transform: translateX(200%);
            transition: 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            z-index: 10000;
        }

        .notification.active {
            transform: translateX(0);
        }

        /* FORM SECTION */
        .form-section {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            background: var(--panel-2);
            padding: 50px;
            border-radius: 40px;
            border: 1px solid var(--glass-border);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            text-transform: uppercase;
            font-weight: 700;
            color: var(--muted);
            margin-bottom: 10px;
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            color: #fff;
            font-family: inherit;
            font-size: 15px;
        }

        .form-input:focus,
        .form-textarea:focus {
            border-color: var(--accent);
        }

        .form-textarea {
            height: 200px;
            resize: none;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(138, 77, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        @media (max-width: 1200px) {
            .sidebar {
                width: 80px;
                padding: 20px 0;
            }

            .logo span,
            .menu-item span,
            .user-details {
                display: none;
            }

            .menu-item {
                justify-content: center;
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <div id="modern-background"></div>
    <div id="toast" class="notification">áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ áƒ¨áƒ”áƒ¡áƒ áƒ£áƒšáƒ”áƒ‘áƒ£áƒšáƒ˜áƒ</div>

    <div class="dashboard">
        <aside class="sidebar">
            <div class="logo-area">
                <a href="index.html" class="logo"><b>GAME</b> <span>DEBATE</span></a>
            </div>
            <ul class="menu">
                <li class="menu-item active" onclick="showSection('users')"><i>ğŸ‘¥</i> <span>áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜</span></li>
                <li class="menu-item" onclick="showSection('news')"><i>ğŸ“°</i> <span>áƒ¡áƒ˜áƒáƒ®áƒšáƒ”áƒ”áƒ‘áƒ˜</span></li>
                <li class="menu-item" onclick="showSection('slider')"><i>ğŸ–¼ï¸</i> <span>áƒ¡áƒšáƒáƒ˜áƒ“áƒ”áƒ áƒ˜</span></li>
                <li class="menu-item" onclick="showSection('comments')"><i>ğŸ’¬</i> <span>áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ”áƒ‘áƒ˜</span></li>
                <li class="menu-item" onclick="showSection('system')"><i>âš™ï¸</i> <span>áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ</span></li>
                <li class="menu-item" onclick="showSection('broadcast')"><i>ğŸ“¢</i> <span>áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ”áƒ‘áƒ˜</span></li>
                <li class="menu-item" onclick="showSection('analytics')"><i>ğŸ“Š</i> <span>áƒ¡áƒ¢áƒáƒ¢áƒ˜áƒ¡áƒ¢áƒ˜áƒ™áƒ</span></li>
                <li class="menu-item" onclick="showSection('logs')"><i>ğŸ“‹</i> <span>áƒšáƒáƒ’áƒ”áƒ‘áƒ˜</span></li>
                <li class="menu-item" onclick="window.location.href='index.html'" style="margin-top:20px; opacity:0.6;">
                    <i>ğŸ </i> <span>áƒ¡áƒáƒ˜áƒ¢áƒ–áƒ” áƒ“áƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ</span>
                </li>
            </ul>
            <div class="user-info" id="adminBadge">
                <img src="" class="avatar" id="adminAvatar">
                <div class="user-details">
                    <h4 id="adminName">Admin</h4>
                    <p>Super Administrator</p>
                </div>
            </div>
        </aside>

        <main class="content">
            <div id="usersSection" class="admin-section">
                <div class="header-bar">
                    <h1 class="section-title">áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ</h1>
                    <button class="action-btn"
                        style="background:var(--accent); border:none; padding:12px 25px; border-radius:15px; font-weight:700;">áƒ”áƒ¥áƒ¡áƒáƒáƒ áƒ¢áƒ˜
                        (CSV)</button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card"><span class="stat-label">áƒ¡áƒ£áƒš áƒáƒ¥áƒ¢áƒ˜áƒ£áƒ áƒ˜</span>
                        <div class="stat-value" id="statTotalUsers">0</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">áƒáƒ“áƒ›áƒ˜áƒœáƒ˜áƒ¡áƒ¢áƒ áƒáƒ¢áƒáƒ áƒ˜</span>
                        <div class="stat-value" id="statAdmins">0</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜ áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ</span>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒáƒ”áƒ‘áƒ˜áƒ¡ áƒ®áƒáƒ áƒ˜áƒ¡áƒ®áƒ˜</span>
                        <div class="stat-value" style="color:var(--success)">100%</div>
                    </div>
                </div>

                <div id="userEditForm" class="form-section" style="display:none;">
                    <h2 style="font-family:Oswald; margin-top:0;">áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ áƒ”áƒ“áƒáƒ¥áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ</h2>
                    <div class="form-group">
                        <label>áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜</label>
                        <input type="text" id="editUsername" class="form-input" placeholder="áƒ¡áƒáƒ®áƒ”áƒšáƒ˜">
                    </div>
                    <div class="form-group">
                        <label>áƒ”áƒš-áƒ¤áƒáƒ¡áƒ¢áƒ</label>
                        <input type="email" id="editEmail" class="form-input" readonly
                            style="opacity:0.6; cursor:not-allowed;">
                    </div>
                    <div class="form-group">
                        <label>áƒ áƒáƒšáƒ˜ (Role)</label>
                        <select id="editRole" class="form-input">
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>áƒáƒ®áƒáƒšáƒ˜ áƒáƒáƒ áƒáƒšáƒ˜ (áƒ“áƒáƒ¢áƒáƒ•áƒ”áƒ— áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜ áƒ—áƒ£ áƒáƒ  áƒ’áƒ¡áƒ£áƒ áƒ— áƒ¨áƒ”áƒªáƒ•áƒšáƒ)</label>
                        <input type="password" id="editPassword" class="form-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="action-btn" style="background:var(--accent); flex-grow:1; padding:15px;"
                            onclick="updateUser()">áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ</button>
                        <button class="action-btn" style="flex-grow:1; padding:15px;"
                            onclick="closeUserForm()">áƒ’áƒáƒ£áƒ¥áƒ›áƒ”áƒ‘áƒ</button>
                    </div>
                </div>

                <div class="data-table-container" id="userTableContainer">
                    <div class="table-header">
                        <span class="table-title">áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ—áƒ áƒ¡áƒ˜áƒ</span>
                        <input type="text" placeholder="áƒ«áƒ”áƒ‘áƒœáƒ (Username, Email)..." class="form-input"
                            style="width:300px; padding:10px 20px; margin:0;" id="userSearch">
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜</th>
                                <th>áƒ”áƒš-áƒ¤áƒáƒ¡áƒ¢áƒ</th>
                                <th>áƒ¡áƒ¢áƒáƒ¢áƒ£áƒ¡áƒ˜</th>
                                <th>IP áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜</th>
                                <th>áƒ‘áƒáƒšáƒ áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ</th>
                                <th>áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ</th>
                            </tr>
                        </thead>
                        <tbody id="userTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="newsSection" class="admin-section" style="display:none;">
                <div class="header-bar">
                    <h1 class="section-title">áƒ¡áƒ˜áƒáƒ®áƒšáƒ”áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ</h1>
                    <button class="action-btn" onclick="openPostForm()"
                        style="background:var(--success); border:none; padding:12px 25px; border-radius:15px; font-weight:700; color:#fff;">áƒáƒ®áƒáƒšáƒ˜
                        áƒáƒáƒ¡áƒ¢áƒ˜ +</button>
                </div>

                <div id="postForm" class="form-section">
                    <h2 style="font-family:Oswald; margin-top:0;">áƒ¡áƒ˜áƒáƒ®áƒšáƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ</h2>
                    <div class="form-group">
                        <label>áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜</label>
                        <input type="text" id="postTitle" class="form-input" placeholder="áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜...">
                    </div>
                    <div class="form-group">
                        <label>áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ</label>
                        <select id="postCategory" class="form-input">
                            <option>Games</option>
                            <option>Hardware</option>
                            <option>Review</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>áƒ¡áƒ£áƒ áƒáƒ—áƒ˜áƒ¡ áƒšáƒ˜áƒœáƒ™áƒ˜ (URL)</label>
                        <input type="text" id="postImg" class="form-input" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label>áƒ›áƒáƒ™áƒšáƒ” áƒáƒ¦áƒ¬áƒ”áƒ áƒ</label>
                        <input type="text" id="postExcerpt" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>áƒ¡áƒ áƒ£áƒšáƒ˜ áƒ¢áƒ”áƒ¥áƒ¡áƒ¢áƒ˜ (HTML áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ—)</label>
                        <textarea id="postFull" class="form-textarea"></textarea>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="action-btn" style="background:var(--accent); flex-grow:1; padding:15px;"
                            onclick="savePost()">áƒ’áƒáƒ›áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ</button>
                        <button class="action-btn" style="flex-grow:1; padding:15px;"
                            onclick="closePostForm()">áƒ’áƒáƒ£áƒ¥áƒ›áƒ”áƒ‘áƒ</button>
                    </div>
                </div>

                <div class="data-table-container" id="newsTableContainer">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜</th>
                                <th>áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ</th>
                                <th>áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜</th>
                                <th>áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ</th>
                            </tr>
                        </thead>
                        <tbody id="newsTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="sliderSection" class="admin-section" style="display:none;">
                <div class="header-bar">
                    <h1 class="section-title">áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ¡áƒšáƒáƒ˜áƒ“áƒ”áƒ áƒ˜ (Hero Command)</h1>
                    <button class="action-btn" onclick="openSliderForm()"
                        style="background:var(--success); border:none; padding:12px 25px; border-radius:15px; font-weight:700; color:#fff;">áƒáƒ®áƒáƒšáƒ˜
                        áƒ¡áƒšáƒáƒ˜áƒ“áƒ˜ +</button>
                </div>

                <div id="sliderForm" class="form-section">
                    <h2 style="font-family:Oswald; margin-top:0;">áƒ¡áƒšáƒáƒ˜áƒ“áƒ˜áƒ¡ áƒ áƒ”áƒ“áƒáƒ¥áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ</h2>
                    <div class="form-group">
                        <label>áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜</label>
                        <input type="text" id="slideTitle" class="form-input" placeholder="áƒ“áƒ˜áƒ“áƒ˜ áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜">
                    </div>
                    <div class="form-group">
                        <label>áƒáƒ¦áƒ¬áƒ”áƒ áƒ</label>
                        <input type="text" id="slideDesc" class="form-input" placeholder="áƒ›áƒáƒ™áƒšáƒ” áƒ¢áƒ”áƒ¥áƒ¡áƒ¢áƒ˜">
                    </div>
                    <div class="form-group">
                        <label>áƒ¤áƒáƒ¢áƒ (URL)</label>
                        <input type="text" id="slideImg" class="form-input" placeholder="https://...">
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="action-btn" style="background:var(--accent); flex-grow:1; padding:15px;"
                            onclick="saveSlide()">áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ</button>
                        <button class="action-btn" style="flex-grow:1; padding:15px;"
                            onclick="closeSliderForm()">áƒ’áƒáƒ£áƒ¥áƒ›áƒ”áƒ‘áƒ</button>
                    </div>
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>áƒ¤áƒáƒ¢áƒ</th>
                                <th>áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜</th>
                                <th>áƒáƒ¦áƒ¬áƒ”áƒ áƒ</th>
                                <th>áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ</th>
                            </tr>
                        </thead>
                        <tbody id="sliderTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="commentsSection" class="admin-section" style="display:none;">
                <div class="header-bar">
                    <h1 class="section-title">áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ (Observer)</h1>
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜</th>
                                <th>áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ˜</th>
                                <th>áƒáƒáƒ¡áƒ¢áƒ˜ ID</th>
                                <th>áƒ“áƒ áƒ</th>
                                <th>áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ</th>
                            </tr>
                        </thead>
                        <tbody id="commentsTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="systemSection" class="admin-section" style="display:none;">
                <div class="header-bar">
                    <h1 class="section-title">áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ£áƒ áƒ˜ áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜ (Neon-CM)</h1>
                </div>

                <div class="analytics-grid">
                    <div class="dark-card">
                        <div class="card-header"><span class="card-title">áƒ¤áƒ”áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ—áƒ”áƒ›áƒ (Theme Engine)</span></div>
                        <div class="form-group">
                            <label>áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ¤áƒ”áƒ áƒ˜ (Accent)</label>
                            <input type="color" id="themeAccent" value="#8a4dff"
                                style="width:100%; height:50px; border:none; background:transparent; cursor:pointer;">
                        </div>
                        <div class="form-group">
                            <label>Glass Opacity (áƒ’áƒáƒ›áƒ­áƒ•áƒ˜áƒ áƒ•áƒáƒšáƒáƒ‘áƒ)</label>
                            <input type="range" id="themeGlass" min="0" max="0.5" step="0.01" value="0.03"
                                style="width:100%;">
                        </div>
                        <button class="action-btn"
                            style="background:var(--accent); width:100%; padding:15px; font-size:16px;"
                            onclick="saveTheme()">áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ</button>
                    </div>

                    <div class="dark-card">
                        <div class="card-header"><span class="card-title">Live Preview</span></div>
                        <div
                            style="padding:20px; border:1px solid var(--glass-border); border-radius:15px; background:rgba(255,255,255,0.03);">
                            <h3 style="color:var(--accent);">áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜</h3>
                            <button class="action-btn">áƒ¦áƒ˜áƒšáƒáƒ™áƒ˜</button>
                            <span class="badge" style="background:var(--accent); color:#fff;">Badge</span>
                        </div>
                    </div>

                    <div class="dark-card" style="grid-column: 1 / -1;">
                        <div class="card-header"><span class="card-title">Gatekeeper (Maintenance Mode)</span></div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <h3 style="margin:0; color:var(--text);">áƒ¡áƒáƒªáƒáƒ•áƒ˜áƒ¡ áƒ©áƒáƒ™áƒ”áƒ¢áƒ•áƒ</h3>
                                <p style="margin:5px 0 0 0; color:var(--muted); font-size:12px;">áƒ›áƒ®áƒáƒšáƒáƒ“ áƒáƒ“áƒ›áƒ˜áƒœáƒ˜áƒ¡áƒ¢áƒ áƒáƒ¢áƒáƒ áƒ”áƒ‘áƒ˜
                                    áƒ¨áƒ”áƒ«áƒšáƒ”áƒ‘áƒ”áƒœ áƒ¡áƒáƒ˜áƒ¢áƒ–áƒ” áƒ¨áƒ”áƒ¡áƒ•áƒšáƒáƒ¡.</p>
                            </div>
                            <button id="maintenanceBtn" class="action-btn" onclick="toggleMaintenance()"
                                style="width:150px; font-weight:bold;">OFF</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dark-card" style="grid-column: 1 / -1; border-color:var(--primary);">
                <div class="card-header"><span class="card-title">Time Machine (Backup & Restore)</span></div>
                <div style="display:flex; gap:20px; align-items:center;">
                    <div style="flex:1;">
                        <h3 style="margin:0; color:var(--text);">áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ áƒ¥áƒ˜áƒ•áƒ˜áƒ áƒ”áƒ‘áƒ</h3>
                        <p style="margin:5px 0 0 0; color:var(--muted); font-size:12px;">áƒ˜áƒœáƒáƒ®áƒáƒ•áƒ¡: áƒ¡áƒšáƒáƒ˜áƒ“áƒ”áƒ‘áƒ¡, áƒ¡áƒ˜áƒáƒ®áƒšáƒ”áƒ”áƒ‘áƒ¡,
                            áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ”áƒ‘áƒ¡, áƒ—áƒ”áƒ›áƒáƒ¡ áƒ“áƒ áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ¡.</p>
                    </div>
                    <button class="action-btn" onclick="exportData()"
                        style="background:var(--secondary); color:#000;">â¬‡ï¸ Backup Download</button>
                    <button class="action-btn" onclick="document.getElementById('importFile').click()"
                        style="background:var(--accent);">â¬†ï¸ Restore Data</button>
                    <input type="file" id="importFile" style="display:none;" onchange="importData(this)">
                </div>
            </div>
    </div>
    </div>

    <div id="broadcastSection" class="admin-section" style="display:none;">
        <div class="header-bar">
            <h1 class="section-title">áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ£áƒ áƒ˜ áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ”áƒ‘áƒ˜ (Voice of God)</h1>
        </div>

        <div class="form-section">
            <h2 style="font-family:Oswald; margin-top:0;">áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</h2>
            <div class="form-group">
                <label>áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ¢áƒ”áƒ¥áƒ¡áƒ¢áƒ˜</label>
                <input type="text" id="broadcastMsg" class="form-input"
                    placeholder="áƒ›áƒáƒ’: áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ˜áƒ¡ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ 10 áƒ¬áƒ£áƒ—áƒ¨áƒ˜...">
            </div>
            <div class="form-group">
                <label>áƒ¢áƒ˜áƒáƒ˜</label>
                <select id="broadcastType" class="form-input"
                    style="background:var(--panel); color:#fff; border:1px solid var(--border);">
                    <option value="info">ğŸ”µ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ (Blue)</option>
                    <option value="warning">ğŸŸ¡ áƒ’áƒáƒ¤áƒ áƒ—áƒ®áƒ˜áƒšáƒ”áƒ‘áƒ (Yellow)</option>
                    <option value="critical">ğŸ”´ áƒ™áƒ áƒ˜áƒ¢áƒ˜áƒ™áƒ£áƒšáƒ˜ (Red)</option>
                </select>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="action-btn" style="background:var(--accent); flex-grow:1; padding:15px;"
                    onclick="sendBroadcast()">áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ (Live)</button>
                <button class="action-btn" style="background:var(--muted); flex-grow:1; padding:15px;"
                    onclick="clearBroadcast()">áƒ’áƒáƒ—áƒ˜áƒ¨áƒ•áƒ</button>
            </div>
            <p style="margin-top:20px; color:var(--muted); font-size:12px;">* áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ áƒ’áƒáƒ›áƒáƒ©áƒœáƒ“áƒ”áƒ‘áƒ áƒ§áƒ•áƒ”áƒšáƒ
                áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ”áƒ™áƒ áƒáƒœáƒ–áƒ” áƒ›áƒ§áƒ˜áƒ¡áƒ˜áƒ”áƒ áƒáƒ“.</p>
        </div>
    </div>

    <div id="logsSection" class="admin-section" style="display:none;">
        <div class="header-bar">
            <h1 class="section-title">áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒáƒ”áƒ‘áƒ˜áƒ¡ áƒšáƒáƒ’áƒ”áƒ‘áƒ˜</h1>
        </div>
        <div class="data-table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜</th>
                        <th>áƒ›áƒáƒ•áƒšáƒ”áƒœáƒ</th>
                        <th>IP / áƒšáƒáƒ™áƒáƒªáƒ˜áƒ</th>
                        <th>áƒ›áƒáƒ¬áƒ§áƒáƒ‘áƒ˜áƒšáƒáƒ‘áƒ</th>
                        <th>áƒ“áƒ áƒ</th>
                    </tr>
                </thead>
                <tbody id="logsTableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="analyticsSection" class="admin-section" style="display:none;">
        <div class="header-bar">
            <h1 class="section-title">áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ£áƒ áƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ¢áƒ˜áƒ™áƒ</h1>
        </div>

        <div class="analytics-grid">
            <div class="dark-card">
                <div class="card-header"><span class="card-title">áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ–áƒ áƒ“áƒ</span></div>
                <div class="trend-item"><span class="trend-label">áƒ‘áƒáƒšáƒ 7 áƒ“áƒ¦áƒ” (áƒ™áƒ•áƒ˜áƒ áƒ)</span><span class="trend-value"
                        id="userWeek">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒ‘áƒáƒšáƒ 30 áƒ“áƒ¦áƒ” (áƒ—áƒ•áƒ”)</span><span class="trend-value"
                        id="userMonth">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒ‘áƒáƒšáƒ 365 áƒ“áƒ¦áƒ” (áƒ¬áƒ”áƒšáƒ˜)</span><span class="trend-value"
                        id="userYear">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒ¡áƒ£áƒš áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜</span><span class="trend-value"
                        id="userTotal">0</span></div>
            </div>
            <div class="dark-card">
                <div class="card-header"><span class="card-title">áƒ¡áƒ˜áƒáƒ®áƒšáƒ”áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ¥áƒ¢áƒ˜áƒ•áƒáƒ‘áƒ</span></div>
                <div class="trend-item"><span class="trend-label">áƒáƒ› áƒ™áƒ•áƒ˜áƒ áƒáƒ¨áƒ˜</span><span class="trend-value"
                        id="newsWeek">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒáƒ› áƒ—áƒ•áƒ”áƒ¨áƒ˜</span><span class="trend-value"
                        id="newsMonth">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒáƒ› áƒ¬áƒ”áƒšáƒ¡</span><span class="trend-value"
                        id="newsYear">0</span></div>
                <div class="trend-item"><span class="trend-label">áƒ¡áƒ£áƒš áƒáƒáƒ¡áƒ¢áƒ”áƒ‘áƒ˜</span><span class="trend-value"
                        id="newsTotal">0</span></div>
            </div>
        </div>

        <div class="analytics-grid">
            <div class="dark-card">
                <div class="card-header"><span class="card-title">áƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒœáƒáƒ¬áƒ˜áƒšáƒ”áƒ‘áƒ</span></div>
                <div id="countryStatsContainer"></div>
            </div>
            <div class="dark-card">
                <div class="card-header"><span class="card-title">áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒ˜áƒšáƒ˜</span></div>
                <div id="categoryStatsContainer"></div>
            </div>

            <div class="dark-card" style="grid-column: 1 / -1; border-color:var(--accent);">
                <div class="card-header"><span class="card-title">Spyglass (Live Activity) ğŸ•µï¸</span></div>
                <div id="spyglassContainer"
                    style="max-height:200px; overflow-y:auto; display:flex; flex-direction:column; gap:8px;">
                    <p style="color:var(--muted); text-align:center;">Waiting for activity...</p>
                </div>
            </div>

        </div>
    </div>
    </main>
    </div>

    <script>
        // SECURITY FIRST
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser || currentUser.email !== 'jaro@gmail.com') {
            window.location.href = 'login.html';
        } else {
            document.body.style.display = 'block';
        }

        // STATE
        let allUsers = [];
        let activeNews = JSON.parse(localStorage.getItem('siteNewsData')) || [
            { id: 1, category: "Hardware", title: "NVIDIA RTX 60 áƒ¡áƒ”áƒ áƒ˜áƒ˜áƒ¡ áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜ áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜", date: "2026-02-08", excerpt: "áƒ˜áƒœáƒ¡áƒáƒ˜áƒ“áƒ”áƒ áƒ£áƒšáƒ˜ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ˜áƒ—, NVIDIA-áƒ¡ áƒáƒ®áƒáƒšáƒ˜ áƒ—áƒáƒáƒ‘áƒ˜áƒ¡ áƒ•áƒ˜áƒ“áƒ”áƒ áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜ 3-áƒ¯áƒ”áƒ  áƒ£áƒ¤áƒ áƒ áƒ¡áƒ¬áƒ áƒáƒ¤áƒ˜ áƒ˜áƒ¥áƒœáƒ”áƒ‘áƒ AI áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ”áƒ‘áƒ¨áƒ˜.", img: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1200" },
            { id: 2, category: "Games", title: "GTA VI-áƒ˜áƒ¡ áƒáƒ®áƒáƒšáƒ˜ áƒ áƒ”áƒ™áƒáƒ áƒ“áƒ˜ - 100 áƒ›áƒ˜áƒšáƒ˜áƒáƒœáƒ˜", date: "2026-02-07", excerpt: "Rockstar Games-áƒ›áƒ áƒáƒ¤áƒ˜áƒªáƒ˜áƒáƒšáƒ£áƒ áƒáƒ“ áƒ“áƒáƒáƒ“áƒáƒ¡áƒ¢áƒ£áƒ áƒ, áƒ áƒáƒ› GTA VI áƒ’áƒáƒ®áƒ“áƒ áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒáƒ“áƒ˜ áƒ›áƒ”áƒ“áƒ˜áƒ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜.", img: "https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1200" },
            { id: 3, category: "Exclusives", title: "Elder Scrolls VI-áƒ˜áƒ¡ áƒ’áƒ”áƒ˜áƒ›áƒ¤áƒšáƒ”áƒ˜", date: "2026-02-06", excerpt: "Bethesda-áƒ¡ áƒ®áƒ”áƒšáƒ›áƒ«áƒ¦áƒ•áƒáƒœáƒ”áƒšáƒáƒ‘áƒáƒ› áƒ’áƒáƒœáƒáƒªáƒ®áƒáƒ“áƒ, áƒ áƒáƒ› áƒ—áƒáƒ›áƒáƒ¨áƒ˜ áƒ›áƒ–áƒáƒ“áƒ”áƒ‘áƒ˜áƒ¡ áƒ‘áƒáƒšáƒ áƒ”áƒ¢áƒáƒáƒ–áƒ”áƒ.", img: "https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=1200" },
            { id: 4, category: "Games", title: "The Witcher 4 áƒ¬áƒáƒ áƒ›áƒáƒ”áƒ‘áƒ áƒ“áƒáƒ˜áƒ¬áƒ§áƒ", date: "2026-02-05", excerpt: "CD Projekt Red-áƒ›áƒ áƒáƒ¤áƒ˜áƒªáƒ˜áƒáƒšáƒ£áƒ áƒáƒ“ áƒ“áƒáƒáƒ“áƒáƒ¡áƒ¢áƒ£áƒ áƒ, áƒ áƒáƒ› áƒáƒ áƒáƒ”áƒ¥áƒ¢áƒ–áƒ” áƒ£áƒ™áƒ•áƒ” 400-áƒ–áƒ” áƒ›áƒ”áƒ¢áƒ˜ áƒ“áƒ”áƒ•áƒ”áƒšáƒáƒáƒ”áƒ áƒ˜ áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ¡.", img: "https://images.unsplash.com/photo-1534423861386-85a16f5d13fd?q=80&w=1200" }
        ];

        let editingNewsId = null;

        // AUTH HEADER HELPER
        function getHeader() {
            return {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${currentUser.token}`
            };
        }

        // CORE UI
        async function showSection(id) {
            document.querySelectorAll('.admin-section').forEach(s => s.style.display = 'none');
            document.getElementById(id + 'Section').style.display = 'block';
            document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
            if (event) {
                const item = event.target.closest('.menu-item');
                if (item) item.classList.add('active');
            }
            if (id === 'users') await fetchUsers();
            if (id === 'news') renderNews();
            if (id === 'logs') await fetchLogs();
            if (id === 'analytics') renderAnalytics();
            if (id === 'slider') renderSlider();
            if (id === 'comments') renderComments();
            if (id === 'system') { loadThemeSettings(); loadMaintenance(); }
            if (id === 'broadcast') loadBroadcast();
        }

        // GATEKEEPER LOGIC
        function loadMaintenance() {
            const m = localStorage.getItem('siteMaintenance') === 'true';
            updateMaintenanceUI(m);
        }

        function toggleMaintenance() {
            const current = localStorage.getItem('siteMaintenance') === 'true';
            const newState = !current;
            localStorage.setItem('siteMaintenance', newState);
            updateMaintenanceUI(newState);
            notify(newState ? 'ğŸ”´ áƒ¡áƒáƒ˜áƒ¢áƒ˜ áƒ©áƒáƒ˜áƒ™áƒ”áƒ¢áƒ!' : 'ğŸŸ¢ áƒ¡áƒáƒ˜áƒ¢áƒ˜ áƒ’áƒáƒ˜áƒ®áƒ¡áƒœáƒ!');
        }

        function updateMaintenanceUI(state) {
            const btn = document.getElementById('maintenanceBtn');
            if (state) {
                btn.style.background = '#ff4757';
                btn.innerText = 'LOCKED ğŸ”’';
            } else {
                btn.style.background = 'var(--success)';
                btn.innerText = 'OPEN ğŸ”“';
            }
        }

        // TIME MACHINE LOGIC
        function exportData() {
            const keys = [
                'siteSliderData',
                'siteNewsData',
                'siteTheme',
                'siteBroadcast',
                'siteMaintenance',
                'newsCommentsLiveV1',
                'newsStatsLiveV3'
            ];

            const backup = {};
            keys.forEach(k => {
                const v = localStorage.getItem(k);
                if (v) backup[k] = JSON.parse(v);
            });

            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            notify('áƒ‘áƒ”áƒ¥áƒáƒáƒ˜ áƒ’áƒáƒ“áƒ›áƒáƒ˜áƒ¬áƒ”áƒ áƒ!');
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    Object.keys(data).forEach(k => {
                        localStorage.setItem(k, JSON.stringify(data[k]));
                    });
                    notify('áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒáƒ¦áƒ“áƒ’áƒ”áƒœáƒ˜áƒšáƒ˜áƒ! áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ áƒ’áƒáƒ“áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...');
                    setTimeout(() => location.reload(), 1500);
                } catch (err) {
                    alert('Error parsing backup file');
                }
            };
            reader.readAsText(file);
        }

        // TIME MACHINE LOGIC
        function exportData() {
            const keys = [
                'siteSliderData',
                'siteNewsData',
                'siteTheme',
                'siteBroadcast',
                'siteMaintenance',
                'newsCommentsLiveV1',
                'newsStatsLiveV3'
            ];

            const backup = {};
            keys.forEach(k => {
                const v = localStorage.getItem(k);
                if (v) backup[k] = JSON.parse(v);
            });

            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            notify('áƒ‘áƒ”áƒ¥áƒáƒáƒ˜ áƒ’áƒáƒ“áƒ›áƒáƒ˜áƒ¬áƒ”áƒ áƒ!');
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    Object.keys(data).forEach(k => {
                        localStorage.setItem(k, JSON.stringify(data[k]));
                    });
                    notify('áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒáƒ¦áƒ“áƒ’áƒ”áƒœáƒ˜áƒšáƒ˜áƒ! áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ áƒ’áƒáƒ“áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...');
                    setTimeout(() => location.reload(), 1500);
                } catch (err) {
                    alert('Error parsing backup file');
                }
            };
            reader.readAsText(file);
        }

        // VOICE OF GOD LOGIC
        function loadBroadcast() {
            const b = JSON.parse(localStorage.getItem('siteBroadcast'));
            if (b) {
                document.getElementById('broadcastMsg').value = b.text;
                document.getElementById('broadcastType').value = b.type;
            }
        }

        function sendBroadcast() {
            const text = document.getElementById('broadcastMsg').value;
            const type = document.getElementById('broadcastType').value;
            if (!text) return notify('áƒ¢áƒ”áƒ¥áƒ¡áƒ¢áƒ˜ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ!');

            localStorage.setItem('siteBroadcast', JSON.stringify({ text, type, active: true, time: Date.now() }));
            notify('áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ áƒ’áƒáƒ˜áƒ’áƒ–áƒáƒ•áƒœáƒ!');
        }

        function clearBroadcast() {
            localStorage.removeItem('siteBroadcast');
            document.getElementById('broadcastMsg').value = '';
            notify('áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ áƒ’áƒáƒ˜áƒ—áƒ˜áƒ¨áƒ');
        }

        // NEON-CM LOGIC
        function loadThemeSettings() {
            const theme = JSON.parse(localStorage.getItem('siteTheme')) || { accent: '#8a4dff', glass: '0.03' };
            document.getElementById('themeAccent').value = theme.accent;
            document.getElementById('themeGlass').value = theme.glass;

            // Live Preview Listener
            document.getElementById('themeAccent').addEventListener('input', (e) => {
                document.documentElement.style.setProperty('--accent', e.target.value);
            });
        }

        function saveTheme() {
            const accent = document.getElementById('themeAccent').value;
            const glass = document.getElementById('themeGlass').value;

            const theme = { accent, glass };
            localStorage.setItem('siteTheme', JSON.stringify(theme));

            // Apply immediately to admin panel too
            document.documentElement.style.setProperty('--accent', accent);
            document.documentElement.style.setProperty('--glass', `rgba(255, 255, 255, ${glass})`);

            notify('áƒ—áƒ”áƒ›áƒ áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ! áƒ§áƒ•áƒ”áƒšáƒ áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ áƒ¨áƒ”áƒ˜áƒªáƒ•áƒšáƒ”áƒ‘áƒ.');
        }

        // OBSERVER LOGIC (COMMENTS)
        function renderComments() {
            const allComments = JSON.parse(localStorage.getItem('newsCommentsLiveV1')) || {};
            const tbody = document.getElementById('commentsTableBody');

            // Flatten comments structure
            let flatComments = [];
            Object.keys(allComments).forEach(postId => {
                allComments[postId].forEach(c => {
                    flatComments.push({ ...c, postId });
                });
            });

            // Sort by newest
            flatComments.sort((a, b) => b.id - a.id);

            tbody.innerHTML = flatComments.map(c => `
                <tr>
                    <td style="display:flex; align-items:center; gap:10px;">
                        <img src="${c.avatar}" style="width:30px; height:30px; border-radius:50%;">
                        <span>${c.username}</span>
                    </td>
                    <td style="max-width:300px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">${c.text}</td>
                    <td>#${c.postId}</td>
                    <td style="font-size:12px; color:var(--muted);">${c.time}</td>
                    <td>
                        <button class="action-btn" onclick="analyzeComment('${c.text.replace(/'/g, "\\'")}', this)" style="background:var(--secondary); color:#000; margin-right:5px;">Oracle ğŸ”®</button>
                        <button class="action-btn del" onclick="deleteCommentAdmin('${c.postId}', ${c.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteCommentAdmin(postId, commentId) {
            if (!confirm('áƒ¬áƒáƒ•áƒ¨áƒáƒšáƒáƒ— áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ˜?')) return;
            const allComments = JSON.parse(localStorage.getItem('newsCommentsLiveV1')) || {};

            if (allComments[postId]) {
                allComments[postId] = allComments[postId].filter(c => c.id !== commentId && c.parentId !== commentId);
                localStorage.setItem('newsCommentsLiveV1', JSON.stringify(allComments));

                // Update stats
                const stats = JSON.parse(localStorage.getItem('newsStatsLiveV3')) || {};
                const key = `comments-${postId}`;
                if (stats[key]) stats[key] = Math.max(0, stats[key] - 1);
                localStorage.setItem('newsStatsLiveV3', JSON.stringify(stats));

                renderComments();
                notify('áƒ™áƒáƒ›áƒ”áƒœáƒ¢áƒáƒ áƒ˜ áƒ¬áƒáƒ˜áƒ¨áƒáƒšáƒ');
            }
        }

        // ORACLE LOGIC (AI ASSISTANT)
        function analyzeComment(text, btn) {
            const positive = ['good', 'great', 'love', 'amazing', 'cool', 'nice', 'best', 'áƒ™áƒáƒ áƒ’áƒ˜', 'áƒ›áƒáƒ›áƒ¬áƒáƒœáƒ¡', 'áƒ›áƒáƒ’áƒáƒ áƒ˜', 'áƒ¡áƒ£áƒáƒ”áƒ '];
            const negative = ['bad', 'hate', 'stupid', 'slow', 'ugly', 'worst', 'áƒªáƒ£áƒ“áƒ˜', 'áƒáƒ áƒ•áƒáƒ áƒ’áƒ', 'áƒ¡áƒáƒ¨áƒ˜áƒœáƒ”áƒšáƒ˜'];

            let score = 0;
            const words = text.toLowerCase().split(/\s+/);
            words.forEach(w => {
                if (positive.some(k => w.includes(k))) score++;
                if (negative.some(k => w.includes(k))) score--;
            });

            const badge = document.createElement('span');
            badge.className = 'badge';
            badge.style.marginRight = '5px';

            if (score > 0) {
                badge.style.background = 'var(--success)';
                badge.innerText = 'POSITIVE';
            } else if (score < 0) {
                badge.style.background = '#ff4757';
                badge.innerText = 'NEGATIVE';
            } else {
                badge.style.background = 'var(--muted)';
                badge.innerText = 'NEUTRAL';
            }

            btn.replaceWith(badge);
        }

        // SLIDER LOGIC (HERO COMMAND)
        let activeSlides = JSON.parse(localStorage.getItem('siteSliderData')) || [
            { title: "Red Dead Redemption 2", desc: "áƒ’áƒáƒ›áƒáƒ¡áƒªáƒáƒ“áƒ”áƒ— áƒ§áƒ•áƒ”áƒšáƒ áƒ“áƒ áƒáƒ˜áƒ¡ áƒ”áƒ áƒ—-áƒ”áƒ áƒ—áƒ˜ áƒ¡áƒáƒ£áƒ™áƒ”áƒ—áƒ”áƒ¡áƒ áƒ áƒáƒ™áƒ¡áƒ—áƒáƒ áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ•áƒ áƒ˜.", img: "https://cdn.cloudflare.steamstatic.com/steam/apps/1174180/library_hero.jpg" },
            { title: "GTA VI: Vice City Returns", desc: "áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ›áƒáƒ¡áƒáƒšáƒáƒ“áƒœáƒ”áƒšáƒ˜ áƒ—áƒáƒ›áƒáƒ¨áƒ˜ áƒ˜áƒ¡áƒ¢áƒáƒ áƒ˜áƒáƒ¨áƒ˜ â€” áƒœáƒáƒ®áƒ”áƒ— áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜ áƒ’áƒ”áƒ˜áƒ›áƒ¤áƒšáƒ”áƒ˜ áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜.", img: "https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1200" },
            { title: "Next-Gen Gaming Hardware", desc: "NVIDIA áƒ“áƒ AMD áƒ”áƒ›áƒ–áƒáƒ“áƒ”áƒ‘áƒ˜áƒáƒœ 2026 áƒ¬áƒšáƒ˜áƒ¡ áƒ áƒ”áƒ•áƒáƒšáƒ£áƒªáƒ˜áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡.", img: "https://images.unsplash.com/photo-1511512578047-dfb367046420?q=80&w=1200" }
        ];
        let editingSlideIndex = null;

        function renderSlider() {
            const tbody = document.getElementById('sliderTableBody');
            tbody.innerHTML = activeSlides.map((s, i) => `
                <tr>
                    <td><img src="${s.img}" style="width:80px; height:45px; object-fit:cover; border-radius:8px;"></td>
                    <td style="font-weight:700;">${s.title}</td>
                    <td style="color:var(--muted); font-size:12px;">${s.desc}</td>
                    <td>
                        <button class="action-btn" onclick="editSlide(${i})">Edit</button>
                        <button class="action-btn del" onclick="deleteSlide(${i})">Del</button>
                    </td>
                </tr>
            `).join('');
        }

        function openSliderForm() {
            document.getElementById('sliderForm').style.display = 'block';
            document.querySelector('#sliderSection .data-table-container').style.display = 'none';
        }

        function closeSliderForm() {
            document.getElementById('sliderForm').style.display = 'none';
            document.querySelector('#sliderSection .data-table-container').style.display = 'block';
            editingSlideIndex = null;
            document.getElementById('slideTitle').value = '';
            document.getElementById('slideDesc').value = '';
            document.getElementById('slideImg').value = '';
        }

        function editSlide(index) {
            editingSlideIndex = index;
            const s = activeSlides[index];
            document.getElementById('slideTitle').value = s.title;
            document.getElementById('slideDesc').value = s.desc;
            document.getElementById('slideImg').value = s.img;
            openSliderForm();
        }

        function saveSlide() {
            const title = document.getElementById('slideTitle').value;
            const desc = document.getElementById('slideDesc').value;
            const img = document.getElementById('slideImg').value;
            if (!title || !img) return notify('áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜ áƒ“áƒ áƒ¤áƒáƒ¢áƒ áƒáƒ£áƒªáƒ˜áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ!');

            if (editingSlideIndex !== null) {
                activeSlides[editingSlideIndex] = { title, desc, img };
            } else {
                activeSlides.push({ title, desc, img });
            }

            localStorage.setItem('siteSliderData', JSON.stringify(activeSlides));
            notify('áƒ¡áƒšáƒáƒ˜áƒ“áƒ”áƒ áƒ˜ áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ!');
            renderSlider();
            closeSliderForm();
        }

        function deleteSlide(index) {
            if (!confirm('áƒ¬áƒáƒ•áƒ¨áƒáƒšáƒáƒ— áƒ¡áƒšáƒáƒ˜áƒ“áƒ˜?')) return;
            activeSlides.splice(index, 1);
            localStorage.setItem('siteSliderData', JSON.stringify(activeSlides));
            renderSlider();
            notify('áƒ¡áƒšáƒáƒ˜áƒ“áƒ˜ áƒ¬áƒáƒ˜áƒ¨áƒáƒšáƒ');
        }

        function renderAnalytics() {
            const now = new Date();
            const week = 7 * 24 * 60 * 60 * 1000;
            const month = 30 * 24 * 60 * 60 * 1000;
            const year = 365 * 24 * 60 * 60 * 1000;

            // USER STATS
            const u7 = allUsers.filter(u => (now - new Date(u.created_at)) < week).length;
            const u30 = allUsers.filter(u => (now - new Date(u.created_at)) < month).length;
            const u365 = allUsers.filter(u => (now - new Date(u.created_at)) < year).length;

            document.getElementById('userWeek').textContent = u7;
            document.getElementById('userMonth').textContent = u30;
            document.getElementById('userYear').textContent = u365;
            document.getElementById('userTotal').textContent = allUsers.length;

            // COUNTRY STATS
            const countries = {};
            allUsers.forEach(u => {
                const c = u.last_country || 'Unknown';
                countries[c] = (countries[c] || 0) + 1;
            });

            const sortedCountries = Object.entries(countries).sort((a, b) => b[1] - a[1]);
            const maxCount = sortedCountries[0]?.[1] || 1;

            document.getElementById('countryStatsContainer').innerHTML = sortedCountries.map(([name, count]) => `
                <div class="country-row">
                    <span class="country-info">${name}</span>
                    <div class="country-bar-bg"><div class="country-bar" style="width:${(count / maxCount) * 100}%"></div></div>
                    <span class="country-count">${count}</span>
                </div>
            `).join('');

            // NEWS STATS
            const n7 = activeNews.filter(n => (now - new Date(n.date)) < week).length;
            const n30 = activeNews.filter(n => (now - new Date(n.date)) < month).length;
            const n365 = activeNews.filter(n => (now - new Date(n.date)) < year).length;

            document.getElementById('newsWeek').textContent = n7;
            document.getElementById('newsMonth').textContent = n30;
            document.getElementById('newsYear').textContent = n365;
            document.getElementById('newsTotal').textContent = activeNews.length;

            // CATEGORY STATS
            const cats = {};
            activeNews.forEach(n => {
                cats[n.category] = (cats[n.category] || 0) + 1;
            });
            const sortedCats = Object.entries(cats).sort((a, b) => b[1] - a[1]);
            const maxCat = sortedCats[0]?.[1] || 1;

            document.getElementById('categoryStatsContainer').innerHTML = sortedCats.map(([name, count]) => `
                <div class="country-row">
                    <span class="country-info">${name}</span>
                    <div class="country-bar-bg"><div class="country-bar" style="width:${(count / maxCat) * 100}%; background:var(--accent-2);"></div></div>
                    <span class="country-count">${count}</span>
                </div>
            `).join('');

            renderSpyglass();
        }

        // SPYGLASS LOGIC
        function renderSpyglass() {
            const logs = JSON.parse(localStorage.getItem('siteActivityLog')) || [];
            const container = document.getElementById('spyglassContainer');

            if (logs.length === 0) {
                container.innerHTML = '<p style="color:var(--muted); text-align:center;">Waiting for activity...</p>';
                return;
            }

            container.innerHTML = logs.slice(0, 10).map(l => `
                <div style="background:rgba(255,255,255,0.05); padding:8px 12px; border-radius:6px; display:flex; justify-content:space-between; align-items:center;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span style="font-size:18px;">${l.icon || 'ğŸ‘¤'}</span>
                        <span style="font-size:13px; color:#fff;">${l.text}</span>
                    </div>
                    <span style="font-size:11px; color:var(--muted);">${timeAgo(l.time)}</span>
                </div>
            `).join('');
        }

        function timeAgo(date) {
            const seconds = Math.floor((new Date() - new Date(date)) / 1000);
            if (seconds < 60) return 'Just now';
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return minutes + 'm ago';
            return Math.floor(minutes / 60) + 'h ago';
        }

        function notify(text) {
            const toast = document.getElementById('toast');
            toast.textContent = text;
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), 3000);
        }

        // USERS LOGIC
        async function fetchUsers() {
            try {
                const res = await fetch('/api/users', { headers: getHeader() });
                if (!res.ok) throw new Error('áƒ¬áƒ•áƒ“áƒáƒ›áƒ áƒ£áƒ•áƒáƒ áƒ’áƒ˜áƒ¡áƒ˜áƒ');
                allUsers = await res.json();
                renderUsers();
            } catch (err) {
                notify('áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡áƒáƒ¡');
                console.error(err);
            }
        }

        function openUserForm(u) {
            document.getElementById('userTableContainer').style.display = 'none';
            document.getElementById('userEditForm').style.display = 'block';
            document.getElementById('editUsername').value = u.username || '';
            document.getElementById('editEmail').value = u.email || '';
            document.getElementById('editRole').value = u.role || 'user';
            document.getElementById('editPassword').value = ''; // Always empty for security
        }

        function closeUserForm() {
            document.getElementById('userTableContainer').style.display = 'block';
            document.getElementById('userEditForm').style.display = 'none';
        }

        function editUser(email) {
            const user = allUsers.find(u => u.email === email);
            if (user) openUserForm(user);
        }

        async function updateUser() {
            const username = document.getElementById('editUsername').value;
            const email = document.getElementById('editEmail').value;
            const role = document.getElementById('editRole').value;
            const password = document.getElementById('editPassword').value;

            try {
                const body = { email, username, role };
                if (password) body.password = password;

                const res = await fetch('/api/users', {
                    method: 'PATCH',
                    headers: getHeader(),
                    body: JSON.stringify(body)
                });

                if (res.ok) {
                    notify('áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ');
                    await fetchUsers();
                    closeUserForm();
                } else {
                    const data = await res.json();
                    notify(data.error || 'áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ˜áƒ¡áƒáƒ¡');
                }
            } catch (err) {
                notify('áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ');
            }
        }

        function renderUsers() {
            const tbody = document.getElementById('userTableBody');
            const search = document.getElementById('userSearch').value.toLowerCase();
            const filtered = allUsers.filter(u => u.username?.toLowerCase().includes(search) || u.email?.toLowerCase().includes(search));

            document.getElementById('statTotalUsers').textContent = allUsers.length;
            document.getElementById('statAdmins').textContent = allUsers.filter(u => u.role === 'admin' || u.email === 'jaro@gmail.com').length;

            tbody.innerHTML = filtered.map(u => `
        <tr>
          <td style="display:flex; align-items:center; gap:12px;">
            <img src="${u.avatar_url || 'https://ui-avatars.com/api/?name=' + u.username}" style="width:32px; height:32px; border-radius:50%; object-fit:cover;">
            <span style="font-weight:700;">${u.username}</span>
          </td>
          <td style="color:var(--muted)">${u.email}</td>
          <td><span class="badge ${u.role === 'admin' ? 'admin' : 'user'}">${u.role || 'User'}</span></td>
          <td style="font-family:monospace; opacity:0.8;">${u.last_ip || 'Hidden'}</td>
          <td style="font-size:12px;">${u.last_login_at ? new Date(u.last_login_at).toLocaleDateString('ka-GE') : 'áƒ“áƒáƒ¤áƒ˜áƒ¥áƒ¡áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡'}</td>
          <td>
            <button class="action-btn" onclick="editUser('${u.email}')">Edit</button>
            <button class="action-btn del" onclick="deleteUser('${u.email}')">Ban</button>
          </td>
        </tr>
      `).join('');
        }

        document.getElementById('userSearch').oninput = renderUsers;

        async function deleteUser(email) {
            if (email === 'jaro@gmail.com') return notify('áƒáƒ“áƒ›áƒ˜áƒœáƒ˜áƒ¡áƒ¢áƒ áƒáƒ¢áƒáƒ áƒ˜áƒ¡ áƒ¬áƒáƒ¨áƒšáƒ áƒ¨áƒ”áƒ£áƒ«áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ!');
            if (!confirm('áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ®áƒáƒ áƒ—?')) return;

            try {
                const res = await fetch('/api/users', {
                    method: 'DELETE',
                    headers: getHeader(),
                    body: JSON.stringify({ email })
                });
                if (res.ok) {
                    allUsers = allUsers.filter(u => u.email !== email);
                    renderUsers();
                    notify('áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ“áƒáƒ‘áƒšáƒáƒ™áƒ˜áƒšáƒ˜áƒ');
                } else {
                    const data = await res.json();
                    notify(data.error || 'áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒ¬áƒáƒ¨áƒšáƒ˜áƒ¡áƒáƒ¡');
                }
            } catch (err) {
                notify('áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ');
            }
        }

        // NEWS LOGIC
        function renderNews() {
            const tbody = document.getElementById('newsTableBody');
            tbody.innerHTML = activeNews.map(n => `
        <tr>
          <td style="color:var(--accent-2); font-weight:700;">#${n.id}</td>
          <td style="font-weight:600;">${n.title}</td>
          <td><span class="badge" style="background:rgba(255,255,255,0.05); border:1px solid var(--glass-border);">${n.category}</span></td>
          <td style="font-size:12px;">${n.date}</td>
          <td>
            <button class="action-btn" onclick="editNews(${n.id})">Edit</button>
            <button class="action-btn del" onclick="deleteNews(${n.id})">Del</button>
          </td>
        </tr>
      `).join('');
        }

        function editNews(id) {
            const item = activeNews.find(n => n.id === id);
            if (!item) return;
            editingNewsId = id;
            document.getElementById('postTitle').value = item.title;
            document.getElementById('postCategory').value = item.category;
            document.getElementById('postImg').value = item.img || '';
            document.getElementById('postExcerpt').value = item.excerpt || '';
            document.getElementById('postFull').value = item.full || '';
            openPostForm();
        }

        function deleteNews(id) {
            if (!confirm('áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ®áƒáƒ áƒ— áƒ áƒáƒ› áƒ’áƒ¡áƒ£áƒ áƒ— áƒ¡áƒ˜áƒáƒ®áƒšáƒ˜áƒ¡ áƒ¬áƒáƒ¨áƒšáƒ?')) return;
            activeNews = activeNews.filter(n => n.id !== id);
            localStorage.setItem('siteNewsData', JSON.stringify(activeNews));
            renderNews();
            notify('áƒ¡áƒ˜áƒáƒ®áƒšáƒ” áƒ¬áƒáƒ˜áƒ¨áƒáƒšáƒ');
        }

        function openPostForm() {
            document.getElementById('newsTableContainer').style.display = 'none';
            document.getElementById('postForm').style.display = 'block';
        }
        function closePostForm() {
            document.getElementById('newsTableContainer').style.display = 'block';
            document.getElementById('postForm').style.display = 'none';
        }

        function savePost() {
            const title = document.getElementById('postTitle').value;
            const category = document.getElementById('postCategory').value;
            const img = document.getElementById('postImg').value;
            const excerpt = document.getElementById('postExcerpt').value;
            const full = document.getElementById('postFull').value;

            if (!title) return notify('áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ˜ áƒáƒ£áƒªáƒ˜áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ!');

            if (editingNewsId) {
                const idx = activeNews.findIndex(n => n.id === editingNewsId);
                activeNews[idx] = { ...activeNews[idx], title, category, img, excerpt, full };
            } else {
                const newId = activeNews.length > 0 ? Math.max(...activeNews.map(n => n.id)) + 1 : 1;
                activeNews.unshift({
                    id: newId,
                    title,
                    category,
                    img,
                    excerpt,
                    full,
                    date: new Date().toLocaleDateString('en-US', { month: 'long', day: '2-digit', year: 'numeric' })
                });
            }

            localStorage.setItem('siteNewsData', JSON.stringify(activeNews));
            editingNewsId = null;
            renderNews();
            notify('áƒ¡áƒ˜áƒáƒ®áƒšáƒ” áƒ¨áƒ”áƒœáƒáƒ®áƒ£áƒšáƒ˜áƒ áƒ“áƒ áƒ’áƒáƒ›áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜áƒ');
            closePostForm();
        }

        // LOGS LOGIC
        async function fetchLogs() {
            try {
                const res = await fetch('/api/security-logs', { headers: getHeader() });
                const data = await res.json();
                const tbody = document.getElementById('logsTableBody');

                tbody.innerHTML = data.logs.map(log => `
            <tr>
              <td>${log.email}</td>
              <td><b style="color:${log.event_type.includes('SUCCESS') ? 'var(--success)' : 'var(--danger)'}">${log.event_type}</b></td>
              <td style="font-family:monospace;">${log.ip_address || 'Unknown'} (${log.country || '??'})</td>
              <td style="font-size:11px;">${log.device || 'Unknown'} / ${log.browser || 'Unknown'}</td>
              <td style="font-size:12px;">${new Date(log.attempt_at).toLocaleString('ka-GE')}</td>
            </tr>
          `).join('');
            } catch (err) {
                notify('áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒšáƒáƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡áƒáƒ¡');
            }
        }

        // INIT
        document.getElementById('adminName').textContent = currentUser.username;
        document.getElementById('adminAvatar').src = currentUser.avatar_url || 'https://ui-avatars.com/api/?name=' + currentUser.username;
        fetchUsers();
    </script>
</body>

</html>